
#Section Epilog
#****Begin: Generated Statements***
#****End: Generated Statements****

# Populate Attributes

sDim = 'Date';

# Month

AttrPutS ( '01', sDim, '2015M01D00', 'Month' );
AttrPutS ( '02', sDim, '2015M02D00', 'Month' );
AttrPutS ( '03', sDim, '2015M03D00', 'Month' );
AttrPutS ( '04', sDim, '2015M04D00', 'Month' );
AttrPutS ( '05', sDim, '2015M05D00', 'Month' );
AttrPutS ( '06', sDim, '2015M06D00', 'Month' );
AttrPutS ( '07', sDim, '2015M07D00', 'Month' );
AttrPutS ( '08', sDim, '2015M08D00', 'Month' );
AttrPutS ( '09', sDim, '2015M09D00', 'Month' );
AttrPutS ( '10', sDim, '2015M10D00', 'Month' );
AttrPutS ( '11', sDim, '2015M11D00', 'Month' );
AttrPutS ( '12', sDim, '2015M12D00', 'Month' );
AttrPutS ( '01', sDim, '2016M01D00', 'Month' );
AttrPutS ( '02', sDim, '2016M02D00', 'Month' );
AttrPutS ( '03', sDim, '2016M03D00', 'Month' );
AttrPutS ( '04', sDim, '2016M04D00', 'Month' );
AttrPutS ( '05', sDim, '2016M05D00', 'Month' );
AttrPutS ( '06', sDim, '2016M06D00', 'Month' );
AttrPutS ( '07', sDim, '2016M07D00', 'Month' );
AttrPutS ( '08', sDim, '2016M08D00', 'Month' );
AttrPutS ( '09', sDim, '2016M09D00', 'Month' );
AttrPutS ( '10', sDim, '2016M10D00', 'Month' );
AttrPutS ( '11', sDim, '2016M11D00', 'Month' );
AttrPutS ( '12', sDim, '2016M12D00', 'Month' );
AttrPutS ( '01', sDim, '2017M01D00', 'Month' );
AttrPutS ( '02', sDim, '2017M02D00', 'Month' );
AttrPutS ( '03', sDim, '2017M03D00', 'Month' );
AttrPutS ( '04', sDim, '2017M04D00', 'Month' );
AttrPutS ( '05', sDim, '2017M05D00', 'Month' );
AttrPutS ( '06', sDim, '2017M06D00', 'Month' );
AttrPutS ( '07', sDim, '2017M07D00', 'Month' );
AttrPutS ( '08', sDim, '2017M08D00', 'Month' );
AttrPutS ( '09', sDim, '2017M09D00', 'Month' );
AttrPutS ( '10', sDim, '2017M10D00', 'Month' );
AttrPutS ( '11', sDim, '2017M11D00', 'Month' );
AttrPutS ( '12', sDim, '2017M12D00', 'Month' );
AttrPutS ( '01', sDim, '2018M01D00', 'Month' );
AttrPutS ( '02', sDim, '2018M02D00', 'Month' );
AttrPutS ( '03', sDim, '2018M03D00', 'Month' );
AttrPutS ( '04', sDim, '2018M04D00', 'Month' );
AttrPutS ( '05', sDim, '2018M05D00', 'Month' );
AttrPutS ( '06', sDim, '2018M06D00', 'Month' );
AttrPutS ( '07', sDim, '2018M07D00', 'Month' );
AttrPutS ( '08', sDim, '2018M08D00', 'Month' );
AttrPutS ( '09', sDim, '2018M09D00', 'Month' );
AttrPutS ( '10', sDim, '2018M10D00', 'Month' );
AttrPutS ( '11', sDim, '2018M11D00', 'Month' );
AttrPutS ( '12', sDim, '2018M12D00', 'Month' );
AttrPutS ( '01', sDim, '2019M01D00', 'Month' );
AttrPutS ( '02', sDim, '2019M02D00', 'Month' );
AttrPutS ( '03', sDim, '2019M03D00', 'Month' );
AttrPutS ( '04', sDim, '2019M04D00', 'Month' );
AttrPutS ( '05', sDim, '2019M05D00', 'Month' );
AttrPutS ( '06', sDim, '2019M06D00', 'Month' );
AttrPutS ( '07', sDim, '2019M07D00', 'Month' );
AttrPutS ( '08', sDim, '2019M08D00', 'Month' );
AttrPutS ( '09', sDim, '2019M09D00', 'Month' );
AttrPutS ( '10', sDim, '2019M10D00', 'Month' );
AttrPutS ( '11', sDim, '2019M11D00', 'Month' );
AttrPutS ( '12', sDim, '2019M12D00', 'Month' );
AttrPutS ( '01', sDim, '2020M01D00', 'Month' );
AttrPutS ( '02', sDim, '2020M02D00', 'Month' );
AttrPutS ( '03', sDim, '2020M03D00', 'Month' );
AttrPutS ( '04', sDim, '2020M04D00', 'Month' );
AttrPutS ( '05', sDim, '2020M05D00', 'Month' );
AttrPutS ( '06', sDim, '2020M06D00', 'Month' );
AttrPutS ( '07', sDim, '2020M07D00', 'Month' );
AttrPutS ( '08', sDim, '2020M08D00', 'Month' );
AttrPutS ( '09', sDim, '2020M09D00', 'Month' );
AttrPutS ( '10', sDim, '2020M10D00', 'Month' );
AttrPutS ( '11', sDim, '2020M11D00', 'Month' );
AttrPutS ( '12', sDim, '2020M12D00', 'Month' );

# Month Hierarchy

sHierarchy = 'Month';
sConsol = 'All Month';

CreateHierarchyByAttribute ( sDim, sHierarchy, 'others', sConsol );

# Year

AttrPutS ( '2015', sDim, '2015M01D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M02D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M03D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M04D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M05D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M06D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M07D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M08D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M09D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M10D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M11D00', 'Year' );
AttrPutS ( '2015', sDim, '2015M12D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M01D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M02D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M03D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M04D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M05D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M06D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M07D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M08D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M09D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M10D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M11D00', 'Year' );
AttrPutS ( '2016', sDim, '2016M12D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M01D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M02D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M03D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M04D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M05D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M06D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M07D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M08D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M09D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M10D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M11D00', 'Year' );
AttrPutS ( '2017', sDim, '2017M12D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M01D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M02D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M03D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M04D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M05D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M06D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M07D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M08D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M09D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M10D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M11D00', 'Year' );
AttrPutS ( '2018', sDim, '2018M12D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M01D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M02D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M03D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M04D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M05D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M06D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M07D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M08D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M09D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M10D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M11D00', 'Year' );
AttrPutS ( '2019', sDim, '2019M12D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M01D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M02D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M03D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M04D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M05D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M06D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M07D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M08D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M09D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M10D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M11D00', 'Year' );
AttrPutS ( '2020', sDim, '2020M12D00', 'Year' );

# Year Hierarchy

sHierarchy = 'Year';
sConsol = 'All Year';

CreateHierarchyByAttribute ( sDim, sHierarchy, 'others', sConsol );

####################################################################################################################
# Create Cubes
#
# Test 1		[ Year, Month, Account, Test 1 Measure ]
# Test 2		[ Date, Account, Test 2 Measure]
# Summary 1		[ Test, Summary 1 Measure ]
# Summary 2		[ Test, Summary 2 Measure ]
#
####################################################################################################################

# Test 1

sCube = 'Test 1';

CubeCreate ( sCube, 'Year', 'Month', 'Account', 'Test 1 Measure ');

CubeRuleAppend( sCube, 'SKIPCHECK;', 1 );
CubeRuleAppend( sCube, '', 1 );
CubeRuleAppend( sCube, '[''Calculated''] = N: 1;', 1 );
CubeRuleAppend( sCube, '', 1 );
CubeRuleAppend( sCube, 'FEEDERS;', 1 );
CubeRuleAppend( sCube, '', 0 );
CubeRuleAppend( sCube, '[''Input''] 		=>	[''Calculated''];', 0 );
CubeRuleAppend( sCube, '[''Calculated''] 	=>	DB(''Summary 1'', ''Test 1'', ''Value'');', 0 );


# Test 2

sCube = 'Test 2';

CubeCreate ( sCube, 'Date', 'Account', 'Test 2 Measure ');

CubeRuleAppend( sCube, 'SKIPCHECK;', 1 );
CubeRuleAppend( sCube, '', 1 );
CubeRuleAppend( sCube, '[''Calculated''] = N: 1;', 1 );
CubeRuleAppend( sCube, '', 1 );
CubeRuleAppend( sCube, 'FEEDERS;', 1 );
CubeRuleAppend( sCube, '', 0 );
CubeRuleAppend( sCube, '[''Input''] 		=>	[''Calculated''];', 0 );
CubeRuleAppend( sCube, '[''Calculated''] 	=>	DB(''Summary 2'', ''Test 2'', ''Value'');', 0 );

# Summary 1

sCube = 'Summary 1';

CubeCreate ( sCube, 'Test', 'Summary 1 Measure ');

CubeRuleAppend( sCube, 'SKIPCHECK;', 1 );
CubeRuleAppend( sCube, '', 1 );
CubeRuleAppend( sCube, '[''Test 1'', ''Value''] = N:	DB(''Test1'', ''All Year'', ''All Month'', ''All Account'', ''Calculated'');', 1 );

# Summary 2

sCube = 'Summary 2';

CubeCreate ( sCube, 'Test', 'Summary 2 Measure ');

CubeRuleAppend( sCube, 'SKIPCHECK;', 1 );
CubeRuleAppend( sCube, '', 1 );
CubeRuleAppend( sCube, '[''Test 2'', ''Value''] = N:	DB(''Test2'', ''Year:All Year'', ''All Account'', ''Calculated'');', 1 );


####################################################################################################################
# Populate Cubes
#
# Test 1		[ Year, Month, Account, Test 1 Measure ]
# Test 2		[ Date, Account, Test 2 Measure]
#
####################################################################################################################

# Test 1

sCube = 'Test 1';

nSizeAccount = 		DimSiz('Account');
nSizeYear = 		DimSiz('Year');
nSizeMonth = 		DimSiz('Month');

# initalise counters

nCountAccount = 	1;
nCountYear = 		1;
nCountMonth = 		1;

# Iterate through the dimensions
# Look up the element name and populate with a 1
# This is not a particularly efficient way to pouplate a cube
# But it works for populating test data

WHILE (nCountYear <= nSizeYear);

	WHILE (nCountMonth <= nSizeMonth);

    	WHILE (nCountAccount <=nSizeAccount);

        	# retrieve elements

        	sYear = 	DIMNM ( 'Year', nCountYear );
            sMonth = 	DIMNM ( 'Month', nCountMonth );
            sAccount = 	DIMNM ( 'Account', nCountAccount );

            # load data only at N Levels

            IF ( 	DTYPE ( 'Year', sYear ) @='N' &
            		DTYPE ( 'Month', sMonth ) @='N' &
                    DTYPE ( 'Account', sAccount ) @='N' );

        		CellPutN ( 1, sCube, sYear, sMonth, sAccount, 'Input' );

            ENDIF;


            # increment account

            nCountAccount = nCountAccount + 1 ;

         END;

		# reset account

		nCountAccount = 1;

        # increment month

        nCountMonth = nCountMonth + 1;

    END;

    # reset month and account

    nCountAccount = 1 ;
    nCountMonth = 1;

    # increment year

    nCountYear = nCountYear + 1;

END;

# Test 2

sCube = 'Test 2';

nSizeAccount = 		DimSiz('Account');
nSizeDate = 		DimSiz('Date');

# initalise counters

nCountAccount = 	1;
nCountDate = 		1;

# Iterate through the dimensions
# Look up the element name and populate with a 1
# This is not a particularly efficient way to pouplate a cube
# But it works for populating test data

WHILE (nCountDate <= nSizeDate);

	WHILE (nCountAccount <= nSizeAccount);

        # retrieve elements

        sDate = 	DIMNM ( 'Date', nCountDate );
        sAccount = 	DIMNM ( 'Account', nCountAccount );

        # load data only at N Levels

        IF ( 	DTYPE ( 'Date', sDate ) @='N' &
		        DTYPE ( 'Account', sAccount ) @='N' );

        	CellPutN ( 1, sCube, sDate, sAccount, 'Input' );

        ENDIF;

	    # increment account

        nCountAccount = nCountAccount + 1 ;

      END;

    # reset month and account

    nCountAccount = 1 ;

    nCountDate = nCountDate + 1;

END;

####################################################################################################################
# Create Views
#
# Test 1		[ Row: Year, Colum: Month, Title: Account, Test 1 Measure ]
# Test 2		[ Row: Date[Year], Date[Month], Title: Account, Test 2 Measure ]
#
####################################################################################################################

# Test 1

sCube = 'Test 1';
sMDX = 	'SELECT ' |
		'NON EMPTY {[Month].[Month].MEMBERS} ON 0, ' |
        'NON EMPTY {[Year].[Year].MEMBERS} ON 1 ' |
        'FROM [Test 1] ' |
        'WHERE ([Account].[Account].[All Account], [Test 1 Measure].[Test 1 Measure].[Calculated]) ';


ViewCreateByMDX(sCube, 'Default', sMDX, 0 );


# Test 2

sCube = 'Test 2';
sMDX = 	'SELECT ' |
		'NON EMPTY {Descendants({[Date].[Month].DEFAULTMEMBER},1, SELF_AND_BEFORE)} ON 0, ' |
		'NON EMPTY {Descendants({[Date].[Year].DEFAULTMEMBER},1, SELF_AND_BEFORE)} ON 1 ' |
        'FROM [Test 2] ' |
        'WHERE ([Account].[Account].[All Account], [Test 2 Measure].[Test 2 Measure].[Calculated]) ';

ViewCreateByMDX(sCube, 'Default', sMDX, 0 );


# Summary 1

sCube = 'Summary 1';
sMDX = 	'SELECT {[Summary 1 Measure].[Summary 1 Measure].MEMBERS} ON 0, ' |
		'{[Test].[Test].MEMBERS} ON 1 ' |
        'FROM [Summary 1] ';

ViewCreateByMDX(sCube, 'Default', sMDX, 0 );

# Summary 2

sCube = 'Summary 2';
sMDX = 	'SELECT {[Summary 2 Measure].[Summary 2 Measure].MEMBERS} ON 0, ' |
		'{[Test].[Test].MEMBERS} ON 1 ' |
        'FROM [Summary 2] ';

ViewCreateByMDX(sCube, 'Default', sMDX, 0 );
